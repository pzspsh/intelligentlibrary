# æ•™ç¨‹

![å›¾ç‰‡](F:\Images\mojoè¯­è¨€ç®€ä»‹.png)

å‰æ®µæ—¶é—´ Modular å‘å¸ƒäº†ä¸€ä¸ªæ–°è¯­è¨€ Mojoï¼Œè¿™è¯­è¨€ä¸æ­¢å®˜ç½‘æ”¾äº†å·¨å¤§çš„ emoji ğŸ”¥ï¼Œè€Œä¸”å®ƒçš„æ ‡å‡†æ–‡ä»¶åç¼€ä¸€ä¸ªæ˜¯ã€Œ.mojoã€å¦ä¸€ä¸ªæ˜¯ã€Œ.ğŸ”¥ã€ï¼Œä¸€å‰¯ç«‹é©¬è¦ç«çš„æ ·å­å‘¢ã€‚

è¯´å®è¯ï¼Œè¿™ä¸ªç”¨ emoji åšåç¼€åçš„æ“ä½œå…¶å®æŒºæ— èŠï¼Œä¹Ÿæœ‰ç‚¹è´¥å¥½æ„Ÿï¼Œä½†å¦‚æœè¯´è¿™ä¸ªè¯­è¨€èƒ½åœ¨å®Œå…¨å…¼å®¹ Python çš„åŸºç¡€ä¸Šå¤§å¹…æé«˜æ‰§è¡Œæ•ˆç‡ï¼Œå¹¶ä¸”ä½œè€…æ˜¯ LLVM å‘èµ·äºº Chris Lattnerï¼Œæ˜¯ä¸æ˜¯çªç„¶åˆæœ‰å…´è¶£ç»§ç»­äº†è§£å®ƒäº†å‘¢ï¼Ÿ

Mojo è¢«è®¾è®¡ä¸º Python è¯­è¨€çš„è¶…é›†ï¼Œå¹¶å¢åŠ äº†è®¸å¤šç‰¹æ€§ï¼ŒåŒ…æ‹¬ï¼š
â–¶ï¸ Progressive typesï¼šèƒ½åˆ©ç”¨ç±»å‹ä¿¡æ¯è·å¾—æ›´å¥½æ€§èƒ½å’Œé™æ€æ£€æŸ¥ï¼Œä½†åˆä¸å¼ºåˆ¶è¦æ±‚å†™ç±»å‹ã€‚
â–¶ï¸ Zero cost abstractionsï¼šC++ çš„æ ¸å¿ƒè®¾è®¡å‡†åˆ™ï¼Œèƒ½å¤Ÿé¿å…ç”¨æˆ·ä¸ºäº†æ€§èƒ½æ”¾å¼ƒåˆç†è®¾è®¡çš„ä»£ç ã€‚
â–¶ï¸ Ownership + borrow checkerï¼šRust è¯­è¨€çš„å®‰å…¨æ€§æ¥æºï¼Œåœ¨ç¼–è¯‘æœŸé¿å…è®¸å¤šé”™è¯¯çš„å‘ç”Ÿã€‚
â–¶ï¸ The full power of MLIRï¼šåŸç”Ÿæ”¯æŒå¯¹ MLIR çš„ç›´æ¥è®¿é—®ï¼Œèƒ½å¤Ÿä»åº•å±‚æ‰©å±•ç³»ç»Ÿã€‚



![å›¾ç‰‡](F:\Images\ä¸ºAIè€Œç”Ÿçš„è¯­è¨€.png)

åœ¨ Mojo è¿™ä¸ªè¯­è¨€çš„ä»‹ç»ä¸­åå¤æåˆ° AIï¼Œå®˜ç½‘ä¹Ÿè¯´å®ƒæ˜¯ã€Œa new programming language for all AI developersã€ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆ AI å¼€å‘éœ€è¦ä¸€ä¸ªæ–°è¯­è¨€å‘¢ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ AI å±Šå…·æœ‰ç»Ÿæ²»åœ°ä½çš„è¯­è¨€å°±æ˜¯ Pythonï¼ŒPython æ˜¯ä¸€ä¸ªè¯­æ³•ç®€å•æ¸…æ™°ï¼Œå®¹æ˜“ä¸Šæ‰‹ï¼Œä¸”çµæ´»åº¦å¾ˆé«˜çš„è¯­è¨€ï¼Œæ·±å—å¹¿å¤§ç¨‹åºå‘˜å–œçˆ±ï¼ŒXKCD ä¸Šæœ‰å°±è¿™ä¹ˆä¸€å¹…æ¼«ç”»ï¼š

![å›¾ç‰‡](F:\Images\xkcd.png)

å½“ç„¶ï¼Œå—äººå–œçˆ±çš„è¯­è¨€æœ‰å¾ˆå¤šï¼ŒPython æˆä¸º AI å±Šçš„ç»Ÿæ²»è¯­è¨€é™¤äº†æœ¬èº«æ˜“ç”¨ä¹‹å¤–ï¼Œä¹Ÿæœ‰æƒ¯æ€§çš„å› ç´ ã€‚ç”±äº Python ä¸Šæœºå™¨å­¦ä¹ ç›¸å…³çš„åº“å¤šï¼Œå› æ­¤æœºå™¨å­¦ä¹ ä»ä¸šè€…ç”¨çš„å°±å¤šï¼Œè¿™åˆåè¿‡æ¥ä»¤æ–°çš„æœºå™¨å­¦ä¹ ç›¸å…³åº“ä¼˜å…ˆä¸º Python æä¾›æ¥å£ï¼Œè¿›ä¸€æ­¥åŠ å¼ºäº†å…¶ç»Ÿæ²»åœ°ä½ã€‚å› æ­¤ï¼Œä¸ºäº†é€æ­¥æ¸—é€è¿™ä¸ªç”¨æˆ·ç¾¤ï¼ŒMojo å…¼å®¹ Python æ˜¯å¾ˆæ­£ç¡®çš„ä¸€ä¸ªé€‰æ‹©ã€‚Mojo ä¸ä»…æ‰¿è¯ºè¯­æ³•æ˜¯ Python çš„è¶…é›†ï¼Œå¹¶ä¸”å®ƒè¿˜èƒ½ç›´æ¥è°ƒç”¨ Python çš„åº“ï¼Œè¿™æ„å‘³ç€ Mojo ä¸éœ€è¦ä»é›¶å¼€å§‹æ„å»ºè‡ªå·±çš„ç”Ÿæ€ï¼Œæœ¬èº«å°±å¯ä»¥ç”¨ä¸Šç¹è£çš„ Python ç”Ÿæ€äº†ã€‚

è™½ç„¶ Python å¾ˆå¥½ï¼Œä½†å®ƒæœ‰ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯å¤ªæ…¢äº†ã€‚è€Œæœºå™¨å­¦ä¹ æœ¬èº«åˆéœ€è¦ç¹é‡çš„è®¡ç®—ï¼Œå› æ­¤ Python ç”Ÿæ€ä¸­å¤§é‡åº“çš„åº•å±‚å…¶å®éƒ½æ˜¯ç”¨é«˜æ€§èƒ½çš„è¯­è¨€ï¼ˆå¦‚ C/C++ï¼‰è¿›è¡Œå®ç°ï¼Œç„¶åå†æä¾›ä¸€ä¸ª Python æ¥å£ä¾›ç”¨æˆ·è°ƒç”¨ï¼Œå…¸å‹çš„å¦‚ numpy è¿™ç§æ•°å­¦åº“ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒPython äº‹å®ä¸Šæ˜¯è¢«ä½œä¸ºä¸€ä¸ªèƒ¶æ°´è¯­è¨€æ¥ä½¿ç”¨ï¼Œè¿™é€ æˆäº†å¼€å‘çš„ç¢ç‰‡åŒ–ï¼Œå¦‚æœä¸€ä¸ªç”¨æˆ·åªæ˜¯ç®€å•è°ƒä¸€ä¸‹åº“é‚£è¿˜å¥½è¯´ï¼Œä½†ä¸€æ—¦åˆ°äº†å·¥ä¸šç•Œï¼Œå¼€å‘è¿‡ç¨‹ä¸­ä¸å¯é¿å…åœ°å°±è¦æ¶‰åŠä¸€äº›åº•å±‚åº“çš„ä¿®æ”¹ï¼Œç”šè‡³ç›´æ¥æ¢è¯­è¨€æ¥å®ç°åŒæ ·çš„åŠŸèƒ½ä»¥æé«˜æ€§èƒ½ï¼Œè¿™ç§å‰²è£‚ä¸æ­¢å¢åŠ äº†å¼€å‘æˆæœ¬å’Œç²¾ç¥è´Ÿæ‹…ï¼Œè€Œä¸”è€ƒè™‘åˆ°ä¼—å¤šæ“…é•¿ C/C++ è¯­è¨€çš„å¼€å‘è€…ä¹Ÿå¹¶ä¸æ˜¯ AI é¢†åŸŸä¸“å®¶ï¼Œè¿™ç§å¼€å‘äººå‘˜èƒ½åŠ›çš„ä¸é€‚é…ä¹Ÿå¯¹æ•´ä¸ª AI ç”Ÿæ€çš„å‘å±•å½¢æˆäº†ä¸€å®šé˜»ç¢ã€‚



å› æ­¤ï¼ŒMojo çš„ç›®çš„å°±æ˜¯è¦åœ¨ Python ç”Ÿæ€çš„åŸºç¡€ä¸Šï¼Œè®©ç”¨æˆ·èƒ½ç”¨ä¸€ä¸ªè¯­è¨€ï¼Œä»ä½¿ç”¨æ˜“ç”¨çš„æ¥å£ï¼Œåˆ°å¼€å‘å¤æ‚çš„åº“ï¼Œå†åˆ°å®ç°åº•å±‚é»‘ç§‘æŠ€ï¼Œç»Ÿä¸€å®éªŒå’Œç”Ÿäº§ç¯å¢ƒæ‰€ç”¨çš„è¯­è¨€ã€‚ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„ï¼ŒMojo æ‰©å±•äº† Python è¯­æ³•ï¼Œæ”¯æŒäº†ç´§å‡‘çš„å†…å­˜å¸ƒå±€ï¼Œå¹¶å¼•å…¥äº†ä¸€äº›ç°ä»£çš„è¯­è¨€ç‰¹æ€§ï¼ˆä¾‹å¦‚ Rust çš„å®‰å…¨æ€§æ£€æŸ¥ï¼‰ï¼Œä½¿å¾—è¿™ä¸ªè¯­è¨€èƒ½å¤Ÿæ¸è¿›å¼åœ°åœ¨ AI ç•Œç«‹è¶³ã€‚è¯´èµ·æ¥ Chris Lattner åœ¨è¿™æ–¹é¢å¯ä»¥ç®—æ˜¯ç»éªŒä¸°å¯Œäº†ï¼Œä¸ç®¡æ˜¯åœ¨ gcc/msvc çš„ç»Ÿæ²»ä¸‹å®ç° clangï¼Œè¿˜æ˜¯åœ¨ objective-c çš„ç»Ÿæ²»ä¸‹ä¸ºè‹¹æœå®ç° swiftï¼Œéƒ½æ˜¯ä¸€ä¸ªé€æ­¥èš•é£Ÿå¯¹æ‰‹å¸‚åœºçš„è¿‡ç¨‹ã€‚

![å›¾ç‰‡](F:\Images\mojoé•¿ä»€ä¹ˆæ ·.png)

è¯´äº†è¿™ä¹ˆå¤šï¼Œè¯¥æ¥çœ‹çœ‹ Mojo é•¿ä»€ä¹ˆæ ·äº†ã€‚ç°åœ¨ Mojo è¿˜ä¸èƒ½ç›´æ¥ä¸‹è½½ä½¿ç”¨ï¼Œå¦‚æœæƒ³è¦å°é²œï¼Œéœ€è¦åœ¨å®˜ç½‘ç”³è¯·ï¼Œç„¶ååœ¨ playground é¡µé¢ä¸­è¯•ç”¨ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäº Jupyter çš„é¡µé¢ï¼Œå¯ä»¥æ··åˆç¬”è®°å’Œå¯æ‰§è¡Œçš„ Mojo ä»£ç ã€‚



å‰é¢æåˆ°ï¼ŒMojo çš„è¯­æ³•æ˜¯ Python çš„è¶…é›†ï¼Œå› æ­¤ Mojo çš„ Hello World ä¹Ÿè·Ÿ Python ä¸€æ ·ç®€å•ï¼š

```python
print("Hello World") #> Hello World


ä¸ Python ä¸€æ ·ï¼ŒMojo ä¹Ÿä½¿ç”¨æ¢è¡Œç¬¦å’Œç¼©è¿›æ¥å®šä¹‰ä»£ç å—ï¼š

fn foo():
    var x: Int = 1
    x += 1
    let y: Int = 1
    print(x, y)  #> 2 1

foo()
```



ä¸Šé¢çš„ä»£ç ä¸­ä½¿ç”¨ var æ¥å£°æ˜å˜é‡ xï¼Œä½¿ç”¨ let æ¥å£°æ˜äº†ä¸å¯å˜é‡ yã€‚Mojo åƒå¾ˆå¤šè¾ƒæ–°è¿‘çš„è¯­è¨€ä¸€æ ·ï¼Œè®©ä¸å¯å˜é‡çš„å£°æ˜å˜å¾—ç®€å•ï¼Œä»¥é¼“åŠ±å¼€å‘è€…ä½¿ç”¨ä¸å¯å˜çš„é‡ã€‚å¦å¤–æ³¨æ„åˆ°è¿™é‡Œå®šä¹‰å‡½æ•°ä½¿ç”¨äº† fn è€Œé Python çš„ defï¼Œè¿™æ˜¯å› ä¸º Mojo å¸Œæœ›åœ¨å…¼å®¹ Python çš„åŸºç¡€ä¸ŠåŠ å…¥ç¼–è¯‘æœŸçš„æ£€æŸ¥å’Œä¼˜åŒ–ï¼Œè€Œ Python è¿‡äºåŠ¨æ€çš„è¯­æ³•å¾ˆéš¾æ”¯æŒè¿™ä¸€ç›®æ ‡ï¼Œå› æ­¤ï¼ŒMojo åŒæ—¶æ”¯æŒä½¿ç”¨ fn å’Œ def ä¸¤ä¸ªå…³é”®å­—æ¥å£°æ˜å‡½æ•°ï¼Œå¯¹äºè°ƒç”¨è€…æ¥è¯´ï¼Œè¿™ä¸¤ç§æ–¹æ³•å£°æ˜å‡ºæ¥çš„å‡½æ•°æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä½†å¯¹äºå®ç°è€…æ¥è¯´ï¼Œå¯ä»¥å°† fn çœ‹ä½œã€Œä¸¥æ ¼æ¨¡å¼ã€ä¸‹çš„ defï¼Œä¾‹å¦‚ä¸‹é¢çš„ä»£ç ä¼šç¼–è¯‘é”™è¯¯ï¼ˆå¦‚æœæ”¹æˆç”¨ def åˆ™ä¸ä¼šå‡ºé”™ï¼‰ï¼š

```python
fn foo(): 
  x = 1 
  print(x) 

# error: Expression [12]:6:5: use of unknown declaration 'x', 'fn' declarations require explicit variable declarations 
# x = 1 
# ^
```



è™½ç„¶å®˜æ–¹æ‰¿è¯º Mojo çš„è¯­æ³•æ˜¯ Python çš„è¶…é›†ï¼Œä½†ç›®å‰ Mojo è¿˜åœ¨å¼€å‘ä¸­ï¼Œå¾ˆå¤š Python è¯­æ³•éƒ½è¿˜ä¸æ”¯æŒï¼Œä¾‹å¦‚ç›®å‰è¿ Python çš„ class éƒ½æ— æ³•è¢«ç¼–è¯‘é€šè¿‡ï¼š

```python
class MyClass:
    def foo():
        pass

# error: Expression [15]:17:5: classes are not supported yet
#     class MyClass:
#     ^

```



ä¸è¿‡ï¼ŒMojo ç°åœ¨å…ˆæä¾›äº†å¦ä¸€ä¸ªç”¨æ¥ç»„ç»‡æ•°æ®çš„å…³é”®å­— structï¼Œç›¸æ¯”äº classï¼Œstruct æ›´åŠ é™æ€å¯æ§ï¼Œä¾¿äºä¼˜åŒ–ã€‚ä¸€æ–¹é¢ï¼Œstruct æ”¯æŒç±»ä¼¼ Python class é£æ ¼çš„å‡½æ•°å£°æ˜å’Œè¿ç®—ç¬¦é‡è½½ã€‚è€Œå¦ä¸€æ–¹é¢ï¼Œstruct åˆç±»ä¼¼äº C++ çš„ struct å’Œ classï¼Œå†…éƒ¨çš„æˆå‘˜åœ¨å†…å­˜ä¸­ç´§å‡‘æ’å¸ƒï¼Œè€Œä¸”ä¸æ”¯æŒåœ¨è¿è¡Œæ—¶åŠ¨æ€æ·»åŠ æˆå‘˜å’Œæ–¹æ³•ï¼Œä¾¿äºç¼–è¯‘æœŸè¿›è¡Œä¼˜åŒ–ï¼Œä¾‹å¦‚ï¼š

```python
struct MyIntPair:
    var first: Int
    var second: Int

    fn __init__(inout self, first: Int, second: Int):
        self.first = first
        self.second = second

    fn __lt__(self, rhs: MyIntPair) -> Bool:
        return self.first < rhs.first or
              (self.first == rhs.first and
               self.second < rhs.second)

let p1 = MyIntPair(1, 2)
let p2 = MyIntPair(2, 1)
if p1 < p2: print("p1 < p2")  #> p1 < p2
```



è™½ç„¶æœ‰ç‚¹ä¸åŒï¼Œä½†æ•´ä½“ä¸Šçœ‹èµ·æ¥è¿˜æ˜¯éå¸¸ç†Ÿæ‚‰çš„å¯¹å§ã€‚è¯´åˆ°è¿™é‡Œï¼Œæœ‰ä¸€ç‚¹éœ€è¦æé†’å„ä½æ³¨æ„ï¼Œå°½ç®¡ Mojo ä¹‹åä¼šä»¤è¯­æ³•æˆä¸º Python è¯­æ³•çš„è¶…é›†ï¼Œä½†å…¶è¯­ä¹‰åˆ™æœ‰æ—¶ä¼šå’Œ Python ä¸åŒï¼Œè¿™æ„å‘³ç€ Python çš„ä»£ç ç›´æ¥æ‹·åˆ° Mojo é‡Œå¯èƒ½ä¼šå‡ºç°ç¼–è¯‘é€šè¿‡ä½†æ‰§è¡Œç»“æœä¸åŒçš„æƒ…å†µï¼Œè¿™é‡Œç®€å•æä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„ä¾‹å­ï¼šå‡½æ•°ä¼ å‚ã€‚åœ¨ Python ä¸­ï¼Œå‡½æ•°ä¼ å‚çš„è¯­ä¹‰ç±»ä¼¼äº C++ çš„ä¼ æŒ‡é’ˆï¼Œåœ¨å‡½æ•°å†…éƒ¨è™½ç„¶ä¸èƒ½æ›´æ”¹è°ƒç”¨è€…æŒ‡å‘çš„å¯¹è±¡ï¼Œä½†å¯ä»¥æ”¹å˜è¯¥å¯¹è±¡å†…éƒ¨çš„çŠ¶æ€ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼š

```python
def foo(lst):
    lst[0] = 5
    print(lst)

x = [1, 2, 3]
foo(x)
print(x)
```

åœ¨ Python ä¸­ï¼Œè¿™æ®µä»£ç æ‰“å°å‡ºæ¥çš„ç»“æœæ˜¯ä¸¤æ¬¡ [5, 2, 3]ã€‚ä½†åœ¨ Mojo ä¸­ï¼Œä½¿ç”¨ def å®šä¹‰çš„å‡½æ•°é»˜è®¤çš„ä¼ é€’é€»è¾‘æ˜¯å¤åˆ¶å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå°½ç®¡åœ¨å‡½æ•°ä¸­èƒ½å¤Ÿä¿®æ”¹å‚æ•°å†…éƒ¨çš„çŠ¶æ€ï¼Œä½†ä¿®æ”¹å¯¹äºè°ƒç”¨æ–¹æ¥è¯´æ˜¯ä¸å¯è§çš„ï¼Œå› æ­¤ä¸Šé¢è¿™æ®µä»£ç åœ¨ Mojo ä¸­æ‰“å°çš„ç»“æœæ˜¯ [5, 2, 3]ï¼ˆfoo å†…éƒ¨ï¼‰å’Œ [1, 2, 3]ï¼ˆfoo å¤–éƒ¨ï¼‰ã€‚

é™¤äº†è¯­æ³•åƒ Pythonï¼ŒMojo éå¸¸åŠ¡å®çš„ä¸€ç‚¹åœ¨äºå®ƒæ„å»ºäº Python çš„ç”Ÿæ€ä¹‹ä¸Šã€‚å› æ­¤å³ä¾¿ Mojo è¿˜æ²¡èƒ½å®Œæ•´æ”¯æŒ Python çš„è¯­æ³•ï¼Œå®ƒè¿˜æ˜¯ä¼˜å…ˆæ”¯æŒäº†å¯¹ Python åº“çš„è°ƒç”¨ï¼Œä»¥ä¾¿è®©å¼€å‘è€…èƒ½å—ç›Šäºåºå¤§å®Œå–„çš„ Python çš„ç”Ÿæ€ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç å°±ä½¿ç”¨äº† Python çš„ numpy åº“ï¼š

```python
from PythonInterface import Python

let np = Python.import_module("numpy")
ar = np.arange(15).reshape(3, 5)
print(ar.shape)   #> (3, 5)
```

![å›¾ç‰‡](F:\Images\åšé‡‡ä¼—é•¿åˆæœ‰æ‰€åˆ›æ–°.png)

Mojo ä½œä¸ºä¸€ä¸ªæ–°è¯­è¨€ï¼Œå¹¿æ³›å¸æ”¶è®¸å¤šç°ä»£çš„ç¨‹åºè¯­è¨€è®¾è®¡æ€æƒ³ï¼Œä¾‹å¦‚ Rust çš„æ‰€æœ‰æƒå’Œå€Ÿç”¨æ£€æŸ¥ï¼Œä»¥æ­¤æå‡ä»£ç çš„å®‰å…¨æ€§ã€‚åœ¨ Mojo ä¸­ï¼Œä½¿ç”¨ fn å®šä¹‰çš„å‡½æ•°çš„å‚æ•°é»˜è®¤ä¼ çš„æ˜¯ä¸å¯å˜çš„å¼•ç”¨ï¼Œå³ã€Œå€Ÿç”¨ã€ï¼Œè°ƒç”¨æ–¹ä»ç„¶æ‹¥æœ‰å…¶æ‰€æœ‰æƒï¼Œå› æ­¤åœ¨å‡½æ•°å†…éƒ¨ä¸å¯ä»¥å¯¹å‚æ•°è¿›è¡Œä¿®æ”¹ã€‚Mojo æä¾›äº†ä¸€ä¸ª borrow å…³é”®å­—æ¥æ ‡æ³¨è¿™æ ·çš„å‚æ•°ä¼ é€’æƒ…å†µï¼Œå¯¹äº fn æ¥è¯´æ˜¯å¯ä»¥çœç•¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸‹é¢ foo å‡½æ•°ä¸­ä¸¤ä¸ªå‚æ•°çš„ä¼ é€’æ–¹å¼ç›¸åŒï¼š

```python
fn foo(borrowed a: SomethingBig, b: SomethingBig):
    a.use()
    b.use()
```

åœ¨ Rust ä¸­ï¼Œä¼ å‚çš„é»˜è®¤è¡Œä¸ºæ˜¯ç§»åŠ¨ï¼Œå¦‚æœéœ€è¦å€Ÿç”¨åˆ™éœ€è¦åœ¨ä¼ å…¥æ—¶åŠ ä¸Š &ï¼Œè¿™ä¸¤ç§æ–¹å¼å€’æ˜¯æ²¡æœ‰å¤ªå¤§çš„ä¼˜åŠ£ä¹‹åˆ†ï¼ŒMojo çš„è¡Œä¸ºå¯èƒ½æ›´æ¥è¿‘äº Python è¿™ç±»é«˜çº§è¯­è¨€çš„ä¹ æƒ¯ã€‚å¦‚æœæƒ³è¦ä¿®æ”¹ä¼ å…¥çš„å‚æ•°ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨æ³¨æ˜ inoutï¼Œä¾‹å¦‚ï¼š

```python
fn swap(inout lhs: Int, inout rhs: Int):
    let tmp = lhs
    lhs = rhs
    rhs = tmp

fn test_swap():
    var x = 42
    var y = 12
    print(x, y)  #> 42, 12
    swap(x, y)
    print(x, y)  #> 12, 42

test_swap()
```

æŒ‰é“ç†è¯´ï¼ŒMojo åº”è¯¥åƒ Rust ä¸€æ ·è§„é¿ä¸€ä¸ªå˜é‡åŒæ—¶è¢«å¯å˜å’Œä¸å¯å˜å€Ÿç”¨ï¼Œä¹Ÿåº”è¯¥è§„é¿åŒæ—¶è¢«å¯å˜å€Ÿç”¨ï¼Œä½†ç›®å‰ Mojo ç¼–è¯‘å™¨ä¼¼ä¹è¿˜æ²¡å®ç°è¿™ä¸€ç‰¹æ€§ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä»£ç è¿˜æ˜¯èƒ½ç¼–è¯‘é€šè¿‡çš„ï¼š

```python
var x = 42
swap(x, x)
```

ä»è¿™ä¹Ÿå¯ä»¥çœ‹å‡º Mojo ç¡®å®è¿˜å¤„åœ¨æ¯”è¾ƒæ—©æœŸçš„å‘å±•é˜¶æ®µã€‚



å¦ä¸€ä¸ªé‡è¦çš„å†…å­˜å®‰å…¨æ¦‚å¿µæ˜¯å¯¹è±¡çš„æ‰€æœ‰æƒï¼Œå½“ä¸€ä¸ªå‡½æ•°è·å–äº†å¯¹è±¡çš„æ‰€æœ‰æƒåï¼Œè°ƒç”¨æ–¹å°±ä¸åº”è¯¥å†å»ä½¿ç”¨è¿™ä¸ªå¯¹è±¡äº†ï¼Œä¾‹å¦‚æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªåªæ”¯æŒç§»åŠ¨çš„ç±»å‹ UniquePtrï¼š

```python
struct UniquePtr:
    var ptr: Int

    fn __init__(inout self, ptr: Int):
        self.ptr = ptr

    fn __moveinit__(inout self, owned existing: Self):
        self.ptr = existing.ptr

    fn __del__(owned self):
        self.ptr = 0
```

åŒæ—¶ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå‡½æ•°ï¼Œå…¶ä¸­ï¼Œuse_ptr ä½¿ç”¨äº†å‰é¢æåˆ°çš„ borrow å…³é”®å­—ï¼Œå€Ÿç”¨äº† UniquePtr å¯¹è±¡ï¼Œè€Œ take_ptr åˆ™ä½¿ç”¨ owned å…³é”®å­—ï¼ŒæŒ‡æ˜å®ƒéœ€è¦è·å–ä¼ å…¥å¯¹è±¡çš„æ‰€æœ‰æƒã€‚é‚£ä¹ˆï¼Œåœ¨è°ƒç”¨ take_ptr çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨å‚æ•°åé¢åŠ ä¸Š ^ åç¼€ï¼Œç”¨æ¥è¡¨æ˜æˆ‘ä»¬å°†æ‰€æœ‰æƒè½¬ç§»ç»™ take_ptrï¼š

```python
fn use_ptr(borrowed p: UniquePtr):
    print(p.ptr)

fn take_ptr(owned p: UniquePtr):
    print(p.ptr)

fn test_ownership():
    let p = UniquePtr(100)
    use_ptr(p)    #> 100
    take_ptr(p^)  #> 100

test_ownership()
```

å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬å°† use_ptr å’Œ take_ptr çš„è°ƒç”¨é¡ºåºè°ƒæ¢ä¸€ä¸‹ï¼Œå°±ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ï¼š

```python
fn test_ownership():
    let p = UniquePtr(100)
    take_ptr(p^)
    use_ptr(p)    # ERROR!

test_ownership()
# error: Expression [13]:23:12: use of uninitialized value 'p'
#    use_ptr(p) # ERROR: p is no longer valid here!
#            ^
```

Mojo çš„å¦ä¸€ä¸ªå¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒè®©å¯¹ MLIR>) çš„æ“ä½œå˜å¾—æ›´ç®€å•ã€‚MLIR å…¨ç§°æ˜¯ Multi-Level Intermediate Representationï¼Œæ˜¯ä¸€ä¸ªç¼–è¯‘å™¨å¼€å‘æ¡†æ¶ï¼Œå®ƒå­˜åœ¨çš„ç›®çš„æ˜¯é€šè¿‡å®šä¹‰å¤šç§æ–¹è¨€æ¥é€çº§å°†ä»£ç è½¬æ¢ä¸ºæœºå™¨ç ï¼Œä»¥é™ä½ç¼–è¯‘å™¨çš„å¼€å‘æˆæœ¬ã€‚åœ¨ MLIR ä¹‹å‰ï¼Œä¸€ä¸ªå¹¿ä¸ºäººç†ŸçŸ¥çš„ IR æ˜¯ LLVM IRï¼Œä¸€ä¸ªè¯­è¨€çš„ç¼–è¯‘å™¨ä½œè€…å¯ä»¥é€šè¿‡å°†è‡ªå·±çš„è¯­è¨€ç¼–è¯‘ä¸º LLVM IR æ¥æ¥å…¥ LLVM çš„å·¥å…·é“¾ï¼Œä½¿å¾—ç¼–è¯‘å™¨ä½œè€…ä¸éœ€è¦å…³å¿ƒåº•å±‚å…·ä½“ç¡¬ä»¶çš„å·®åˆ«ï¼Œå®ç°äº†å¯¹åº•å±‚ç¼–è¯‘å·¥å…·é“¾çš„å¤ç”¨ï¼š

![å›¾ç‰‡](F:\Images\ç¼–è¯‘å·¥å…·.png)

ä½† LLVM IR å±‚çº§è¿‡ä½ï¼Œéš¾ä»¥è¿›è¡Œç‰¹å®šäºè¯­è¨€æœ¬èº«çš„ä¼˜åŒ–ï¼Œä»ä¸Šé¢çš„å›¾ä¸­ä¹Ÿèƒ½çœ‹å‡ºï¼Œå„ä¸ªè¯­è¨€ä¸ºäº†å®ç°è¯­è¨€æœ¬èº«çš„ä¼˜åŒ–ï¼Œéƒ½åœ¨ç¼–è¯‘ä¸º LLVM IR ä¹‹å‰åŠ å…¥äº†è‡ªå·±çš„ IRã€‚å¦å¤– LLVM IR æ‰©å±•èµ·æ¥ä¹Ÿéå¸¸å›°éš¾ï¼Œéš¾ä»¥é€‚åº”å¤æ‚å¼‚æ„è®¡ç®—çš„è¦æ±‚ï¼Œè€Œå¼‚æ„è®¡ç®—åœ¨ AI å¼€å‘ä¸­åˆéå¸¸æ™®éã€‚MLIR ç›¸æ¯”äºä¹‹å‰çš„ IRï¼Œæ›´åŠ æ¨¡å—åŒ–ï¼Œä»…ä¿ç•™äº†ä¸€ä¸ªéå¸¸å°çš„å†…æ ¸ï¼Œæ–¹ä¾¿å¼€å‘è€…è¿›è¡Œæ‰©å±•ã€‚å¾ˆå¤šç¼–è¯‘å™¨å°†ä»£ç ç¼–è¯‘ä¸º MLIRï¼Œè€Œ Mojo æä¾›äº†ç›´æ¥è®¿é—® MLIR çš„èƒ½åŠ›ï¼Œè¿™ä½¿å¾— Mojo èƒ½å¤Ÿå—ç›Šäºè¿™äº›å·¥å…·ã€‚æ›´å¤šå…³äº MLIR çš„å†…å®¹å¯ä»¥å‚è€ƒè¿™ä¸€ç³»åˆ—æ–‡ç« ï¼šç¼–è¯‘å™¨ä¸ä¸­é—´è¡¨ç¤º: LLVM IR, SPIR-V, ä»¥åŠ MLIRï¼Œè¿™é‡Œå°±ä¸åšè¿‡å¤šèµ˜è¿°ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨åœ¨ Mojo ä¸­å¯ä»¥å¦‚ä½•æ“ä½œ MLIRã€‚ä¸¾ä¾‹è€Œè¨€ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›å®ç°ä¸€ä¸ªæ–°çš„ boolean ç±»å‹ OurBoolï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®ç°ï¼š

```python
alias OurTrue: OurBool = __mlir_attr.`true`
alias OurFalse: OurBool = __mlir_attr.`false`

@register_passable("trivial")
struct OurBool:
    var value: __mlir_type.i1

    fn __init__() -> Self:
        return OurFalse

    fn __init__(value: __mlir_type.i1) -> Self:
        return Self {value: value}

    fn __bool__(self) -> Bool:
        return Bool(self.value)
```

è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªç±»å‹ä¸º OurBool çš„ç±»å‹ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªç›´æ¥ä½¿ç”¨ MLIR å†…ç½®ç±»å‹ i1 çš„æˆå‘˜ value ã€‚åœ¨ Mojo ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ __mlir_type.typename çš„å½¢å¼æ¥è®¿é—® MLIR ç±»å‹ã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä¸ºè¿™ä¸ªç±»å‹æä¾›äº†ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹æ„é€ ä¸º OurFalse ä¹Ÿå¯åŸºäºä¼ å…¥çš„å‚æ•°è¿›è¡Œæ„å»ºã€‚æœ€ä¸‹é¢çš„ __bool__ ä¹Ÿå’Œ Python çš„ __bool__ ä¸€æ ·ï¼Œç”¨äºä½¿è¯¥ç±»å‹å…·æœ‰å’Œå†…ç½® boolean ç±»å‹çš„æ€§è´¨ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨å®ƒï¼š

```python
let t: OurBool = OurTrue
if t: print("true")  #> true
```

é™¤äº†ä½¿ç”¨ MLIR ä¹‹å¤–ï¼ŒMojo ç”šè‡³å¯ä»¥å…è®¸å¼€å‘è€…ä½¿ç”¨ MLIR å®ç°é€»è¾‘ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä»£ç ä¸­é€šè¿‡åº”ç”¨ MLIR çš„ index.casts æ“ä½œæ¥å®ç°ç±»å‹è½¬æ¢ï¼Œç„¶åå†é€šè¿‡ index.cmp å¯¹å€¼è¿›è¡Œæ¯”è¾ƒï¼š

```python
# ...
struct OurBool:
    # ...
    fn __eq__(self, rhs: OurBool) -> Self:
        let lhsIndex = __mlir_op.`index.casts`[_type : __mlir_type.index](
            self.value
        )
        let rhsIndex = __mlir_op.`index.casts`[_type : __mlir_type.index](
            rhs.value
        )
        return Self(
            __mlir_op.`index.cmp`[
                pred : __mlir_attr.`#index<cmp_predicate eq>`
            ](lhsIndex, rhsIndex)
        )
```

åŸºäºå°è£…å¥½çš„ __eq__ æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“å®ç° __invert__ æ–¹æ³•ï¼š

```python
# ...
struct OurBool:
    # ...
    fn __invert__(self) -> Self:
        return OurFalse if self == OurTrue else OurTrue
```

æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹ OurBool ç±»å‹çš„å¯¹è±¡ä½¿ç”¨ ~ æ“ä½œç¬¦äº†ï¼š

```python
let f = OurFalse
if ~f: print("false")  #> false
```

é€šè¿‡è¿™ä¸ªç®€å•çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œåœ¨ Mojo ä¸­ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡è®¿é—® MLIR æ¥å®ç°å’Œå†…ç½®ç±»å‹åŒç­‰é«˜æ•ˆçš„ç±»å‹ã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥åœ¨ Mojo ä¸Šä¸ºæ–°ç¡¬ä»¶çš„æ•°æ®ç±»å‹å°è£…é«˜æ•ˆç®€å•çš„ Mojo æ¥å£è€Œä¸éœ€è¦åˆ‡æ¢è¯­è¨€ã€‚è™½ç„¶å¤§éƒ¨åˆ†å¼€å‘è€…å¹¶ä¸éœ€è¦æ¥è§¦ MLIRï¼Œä½† Mojo ä¸ºæ›´æ·±å…¥å’Œæ›´åº•å±‚çš„ä¼˜åŒ–æä¾›äº†å……åˆ†çš„å¯èƒ½æ€§ã€‚

